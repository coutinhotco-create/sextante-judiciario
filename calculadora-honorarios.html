<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de Honorários Advocatícios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; line-height: 1.6; }
    .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .voltar { max-width: 900px; margin: 0 auto 20px; }
    .voltar a { display: inline-flex; align-items: center; gap: 8px; color: #667eea; text-decoration: none; font-size: 14px; font-weight: 500; transition: opacity 0.3s; }
    .voltar a:hover { opacity: 0.7; }
    h1 { color: #333; margin-bottom: 10px; font-size: 24px; }
    .subtitle { color: #666; margin-bottom: 20px; font-size: 14px; }
    .campo { margin-bottom: 20px; }
    label { display: block; margin-bottom: 6px; font-weight: 500; color: #333; font-size: 14px; }
    input[type="number"] { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; }
    input:focus { outline: none; border-color: #667eea; }
    .checkbox-group { display: flex; flex-direction: column; gap: 15px; }
    .checkbox-option { border: 1px solid #e0e0e0; border-radius: 6px; padding: 15px; transition: all 0.3s; }
    .checkbox-option.active { border-color: #667eea; background: #f8f9ff; }
    .checkbox-option input[type="checkbox"] { margin-right: 8px; cursor: pointer; }
    .checkbox-option label { margin: 0; cursor: pointer; font-weight: 600; color: #333; }
    .checkbox-option .descricao { font-size: 13px; color: #666; margin-top: 5px; margin-left: 24px; }
    .percentual-input { margin-top: 10px; margin-left: 24px; display: none; }
    .percentual-input.ativo { display: block; }
    .percentual-input input { width: 150px; }
    .erro { color: #d32f2f; font-size: 13px; margin-top: 5px; display: none; }
    .erro.ativo { display: block; }
    .resumo { background: #f9f9f9; border: 1px solid #e0e0e0; padding: 20px; border-radius: 6px; margin: 20px 0; display: none; }
    .resumo.ativo { display: block; }
    .resumo h3 { font-size: 18px; color: #333; margin-bottom: 15px; }
    .resumo-item { margin-bottom: 8px; color: #555; font-size: 14px; }
    .resumo-item strong { color: #333; }
    button { width: 100%; padding: 14px; background: #667eea; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background 0.3s; margin-top: 10px; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    button:hover:not(:disabled) { background: #5568d3; }
    .cards-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 30px; }
    .card { background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .card-title { font-size: 12px; text-transform: uppercase; color: #999; margin-bottom: 10px; font-weight: 600; }
    .card-valor { font-size: 24px; font-weight: 700; color: #333; margin-bottom: 15px; }
    .card-detalhe { font-size: 13px; color: #666; margin-bottom: 5px; }
    .card-total .card-detalhe { color: rgba(255,255,255,0.95); }
    .card-percentual { font-size: 18px; font-weight: 600; color: #667eea; margin-top: 10px; }
    .card-total { grid-column: 1 / -1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 30px; }
    .card-total .card-title { color: rgba(255,255,255,0.9); }
    .card-total .card-valor { color: white; font-size: 36px; }
    .resultado { display: none; margin-top: 30px; }
    .resultado.ativo { display: block; }
    .certidao-section { background: #f9f9f9; border: 1px solid #e0e0e0; padding: 20px; border-radius: 6px; margin-top: 30px; display: none; }
    .certidao-section.ativo { display: block; }
    .certidao-section h3 { font-size: 18px; color: #333; margin-bottom: 15px; }
    .certidao-checkbox { display: flex; align-items: center; margin-bottom: 20px; }
    .certidao-checkbox input { margin-right: 8px; cursor: pointer; }
    .certidao-checkbox label { cursor: pointer; font-weight: 600; color: #333; }
    .certidao-campos { display: none; }
    .certidao-campos.ativo { display: block; }
    .campo-opcional { font-size: 12px; color: #999; font-weight: normal; }
    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); overflow: auto; }
    .modal.ativo { display: block; }
    .modal-content { background: white; margin: 20px auto; max-width: 900px; position: relative; }
    .modal-header { padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; display: flex; justify-content: space-between; align-items: center; }
    .modal-header h2 { font-size: 20px; }
    .modal-close { background: rgba(255,255,255,0.2); border: none; color: white; font-size: 28px; cursor: pointer; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; transition: background 0.3s; }
    .modal-close:hover { background: rgba(255,255,255,0.3); }
    .modal-body { padding: 40px; }
    .modal-buttons { padding: 20px; background: #f9f9f9; display: flex; gap: 10px; justify-content: flex-end; }
    .btn-secondary { background: #718096; }
    .btn-secondary:hover { background: #4a5568; }
    .certidao-preview { font-family: 'Times New Roman', serif; line-height: 1.8; color: #000; }
    .certidao-preview h2 { text-align: center; font-size: 18px; margin-bottom: 30px; text-transform: uppercase; }
    .certidao-preview .orgao { text-align: center; font-weight: bold; margin-bottom: 20px; font-size: 16px; }
    .certidao-preview .titulo { text-align: center; font-weight: bold; margin: 30px 0 20px; font-size: 16px; }
    .certidao-preview .corpo { text-align: justify; margin-bottom: 15px; font-size: 14px; }
    .certidao-preview table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }
    .certidao-preview table th, .certidao-preview table td { border: 1px solid #000; padding: 8px; text-align: left; }
    .certidao-preview table th { background: #f0f0f0; font-weight: bold; }
    .certidao-preview .assinatura { margin-top: 60px; text-align: center; }
    .certidao-preview .assinatura-linha { border-top: 1px solid #000; width: 300px; margin: 0 auto 10px; }
    .alvara-preview { font-family: 'Times New Roman', serif; line-height: 1.8; color: #000; white-space: pre-wrap; }
    @media print {
      body { background: white; padding: 0; }
      .container, .voltar, .modal-header, .modal-buttons { display: none; }
      .modal { display: block; position: static; background: white; }
      .modal-content { margin: 0; max-width: 100%; box-shadow: none; }
      .modal-body { padding: 40px; }
      .certidao-preview, .alvara-preview { font-size: 12pt; }
    }
  </style>
</head>
<body>
  <div class="voltar">
    <a href="index.html">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      <span>Sextante Judiciário</span>
    </a>
  </div>

  <div class="container">
    <h1>Calculadora de Honorários Advocatícios</h1>
    <p class="subtitle">Apuração de honorários contratuais e sucumbenciais</p>
    
    <div class="campo">
      <label>Valor total do depósito judicial</label>
      <div style="position: relative;">
        <span style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #666; font-size: 14px; pointer-events: none;">R$</span>
        <input type="text" id="valorDeposito" placeholder="0,00" style="padding-left: 35px;" inputmode="decimal">
      </div>
      <div id="erroDeposito" class="erro"></div>
    </div>
    
    <div class="campo">
      <label>Tipo de honorários a calcular</label>
      <div class="checkbox-group">
        <div class="checkbox-option" id="optionSucumb">
          <div>
            <input type="checkbox" id="checkSucumb">
            <label for="checkSucumb">Honorários sucumbenciais</label>
          </div>
          <div class="descricao">Calculados mediante regra de três simples sobre o depósito total</div>
          <div class="percentual-input" id="divSucumb">
            <label>Percentual (%)</label>
            <input type="number" id="percSucumb" min="0" max="100" step="0.01" placeholder="0,00">
            <div id="erroSucumb" class="erro"></div>
          </div>
        </div>
        
        <div class="checkbox-option" id="optionContrat">
          <div>
            <input type="checkbox" id="checkContrat">
            <label for="checkContrat">Honorários contratuais</label>
          </div>
          <div class="descricao">Calculados diretamente sobre o valor da condenação</div>
          <div class="percentual-input" id="divContrat">
            <label>Percentual (%)</label>
            <input type="number" id="percContrat" min="0" max="100" step="0.01" placeholder="0,00">
            <div id="erroContrat" class="erro"></div>
          </div>
        </div>
      </div>
    </div>
    
    <div id="resumo" class="resumo">
      <h3>Resumo dos dados informados</h3>
      <div id="resumoTexto"></div>
    </div>
    
    <button id="btnCalc" disabled>Calcular honorários</button>
    
    <div id="resultado" class="resultado">
      <h2 style="text-align:center; color:#333; margin-bottom:20px;">Resultado do cálculo</h2>
      <div id="cardsResultado" class="cards-container"></div>
      
      <div id="certidaoSection" class="certidao-section">
        <div class="certidao-checkbox">
          <input type="checkbox" id="checkCertidao">
          <label for="checkCertidao">Gerar certidão oficial e/ou minuta de alvará</label>
        </div>
        
        <div id="certidaoCampos" class="certidao-campos">
          <h3 style="margin-bottom:20px; color:#667eea;">Dados para emissão de documentos</h3>
          
          <div class="campo">
            <label>Órgão judiciário</label>
            <input type="text" id="orgaoJudiciario" placeholder="Ex: 1ª Vara Cível de Teresina/PI" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Número do processo</label>
            <input type="text" id="numeroProcesso" placeholder="Ex: 0000000-00.0000.0.00.0000" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>ID do depósito judicial</label>
            <input type="text" id="idDeposito" placeholder="Ex: DEP-2024-12345" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Número da conta judicial</label>
            <input type="text" id="contaJudicial" placeholder="Ex: 00000000-0" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Nome da parte</label>
            <input type="text" id="nomeParte" placeholder="Nome completo" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>CPF da parte</label>
            <input type="text" id="cpfParte" placeholder="000.000.000-00" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Nome do(a) advogado(a)</label>
            <input type="text" id="nomeAdvogado" placeholder="Nome completo" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>OAB</label>
            <input type="text" id="oabAdvogado" placeholder="Ex: 12345/PI" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>ID da sentença/acórdão <span class="campo-opcional">(honorários sucumbenciais - opcional)</span></label>
            <input type="text" id="idSentenca" placeholder="Ex: Sentença ID 2024-001" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>ID do contrato de honorários <span class="campo-opcional">(honorários contratuais - opcional)</span></label>
            <input type="text" id="idContrato" placeholder="Ex: Contrato nº 001/2024" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Nome do servidor responsável</label>
            <input type="text" id="nomeServidor" placeholder="Nome completo" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Cargo do servidor</label>
            <input type="text" id="cargoServidor" placeholder="Ex: Analista Judiciário" style="padding: 12px; font-size: 14px;">
          </div>
          
          <div class="campo">
            <label>Data da certidão</label>
            <input type="date" id="dataCertidao" style="padding: 12px; font-size: 14px;">
          </div>
          
          <button id="btnGerarCertidao" disabled style="margin-top:20px;">Visualizar certidão</button>
          <button id="btnGerarAlvara" disabled style="margin-top:10px; background:#718096;">Visualizar minuta de alvará</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Certidão -->
  <div id="modalCertidao" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Certidão de Apuração de Honorários</h2>
        <button class="modal-close" onclick="document.getElementById('modalCertidao').classList.remove('ativo')">&times;</button>
      </div>
      <div class="modal-body">
        <div id="certidaoConteudo" class="certidao-preview"></div>
      </div>
      <div class="modal-buttons">
        <button class="btn-secondary" onclick="document.getElementById('modalCertidao').classList.remove('ativo')">Fechar</button>
        <button onclick="window.print()">Imprimir / Salvar PDF</button>
      </div>
    </div>
  </div>

  <!-- Modal Alvará -->
  <div id="modalAlvara" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Minuta de Alvará de Liberação</h2>
        <button class="modal-close" onclick="document.getElementById('modalAlvara').classList.remove('ativo')">&times;</button>
      </div>
      <div class="modal-body">
        <div id="alvaraConteudo" class="alvara-preview"></div>
      </div>
      <div class="modal-buttons">
        <button class="btn-secondary" onclick="document.getElementById('modalAlvara').classList.remove('ativo')">Fechar</button>
        <button onclick="window.print()">Imprimir / Salvar PDF</button>
      </div>
    </div>
  </div>

  <script>
    const fmt = new Intl.NumberFormat('pt-BR', {style: 'currency', currency: 'BRL', minimumFractionDigits: 2, maximumFractionDigits: 2});
    const fmtPct = new Intl.NumberFormat('pt-BR', {style: 'percent', minimumFractionDigits: 2, maximumFractionDigits: 2});
    
    let dadosCalculo = null;
    
    const valorDeposito = document.getElementById('valorDeposito');
    const erroDeposito = document.getElementById('erroDeposito');
    const checkSucumb = document.getElementById('checkSucumb');
    const checkContrat = document.getElementById('checkContrat');
    const optionSucumb = document.getElementById('optionSucumb');
    const optionContrat = document.getElementById('optionContrat');
    const divSucumb = document.getElementById('divSucumb');
    const divContrat = document.getElementById('divContrat');
    const percSucumb = document.getElementById('percSucumb');
    const percContrat = document.getElementById('percContrat');
    const erroSucumb = document.getElementById('erroSucumb');
    const erroContrat = document.getElementById('erroContrat');
    const resumo = document.getElementById('resumo');
    const resumoTexto = document.getElementById('resumoTexto');
    const btnCalc = document.getElementById('btnCalc');
    const resultado = document.getElementById('resultado');
    const cardsResultado = document.getElementById('cardsResultado');
    const certidaoSection = document.getElementById('certidaoSection');
    const checkCertidao = document.getElementById('checkCertidao');
    const certidaoCampos = document.getElementById('certidaoCampos');
    const btnGerarCertidao = document.getElementById('btnGerarCertidao');
    const btnGerarAlvara = document.getElementById('btnGerarAlvara');
    
    function getHoje() {
      const h = new Date();
      return h.getFullYear() + '-' + String(h.getMonth()+1).padStart(2,'0') + '-' + String(h.getDate()).padStart(2,'0');
    }
    
    function formatarData(iso) {
      if (!iso) return '';
      const [a, m, d] = iso.split('-');
      return `${d}/${m}/${a}`;
    }
    
    function valorPorExtenso(valor) {
      const unidades = ['', 'um', 'dois', 'três', 'quatro', 'cinco', 'seis', 'sete', 'oito', 'nove'];
      const especiais = ['dez', 'onze', 'doze', 'treze', 'quatorze', 'quinze', 'dezesseis', 'dezessete', 'dezoito', 'dezenove'];
      const dezenas = ['', '', 'vinte', 'trinta', 'quarenta', 'cinquenta', 'sessenta', 'setenta', 'oitenta', 'noventa'];
      const centenas = ['', 'cento', 'duzentos', 'trezentos', 'quatrocentos', 'quinhentos', 'seiscentos', 'setecentos', 'oitocentos', 'novecentos'];
      
      function porExtenso(n) {
        if (n === 0) return 'zero';
        if (n === 100) return 'cem';
        if (n < 10) return unidades[n];
        if (n < 20) return especiais[n - 10];
        if (n < 100) {
          const d = Math.floor(n / 10);
          const u = n % 10;
          return dezenas[d] + (u > 0 ? ' e ' + unidades[u] : '');
        }
        if (n < 1000) {
          const c = Math.floor(n / 100);
          const r = n % 100;
          return centenas[c] + (r > 0 ? ' e ' + porExtenso(r) : '');
        }
        if (n < 1000000) {
          const m = Math.floor(n / 1000);
          const r = n % 1000;
          const milhar = m === 1 ? 'mil' : porExtenso(m) + ' mil';
          return milhar + (r > 0 ? (r < 100 ? ' e ' : ' ') + porExtenso(r) : '');
        }
        return n.toString();
      }
      
      const partes = valor.toFixed(2).split('.');
      const reais = parseInt(partes[0]);
      const centavos = parseInt(partes[1]);
      
      let texto = '';
      if (reais > 0) {
        texto += porExtenso(reais) + (reais === 1 ? ' real' : ' reais');
      }
      if (centavos > 0) {
        if (reais > 0) texto += ' e ';
        texto += porExtenso(centavos) + (centavos === 1 ? ' centavo' : ' centavos');
      }
      if (reais === 0 && centavos === 0) texto = 'zero reais';
      
      return texto;
    }
    
  function getValorNumerico(valorFormatado) {
    if (!valorFormatado) return 0;
    const valorLimpo = String(valorFormatado).replace(/\./g, '').replace(',', '.');
    return parseFloat(valorLimpo) || 0;
  }

  function formatarInputMilhar(input) {
    let valor = input.value.replace(/\D/g, '');
    if (valor === '') {
        input.value = '';
        return;
    }
    valor = (parseInt(valor, 10) / 100).toLocaleString('pt-BR', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
    });
    if (valor === 'NaN') {
        input.value = '';
        return;
    }
    input.value = valor;
  }

    checkSucumb.addEventListener('change', () => {
      if (checkSucumb.checked) {
        divSucumb.classList.add('ativo');
        optionSucumb.classList.add('active');
      } else {
        divSucumb.classList.remove('ativo');
        optionSucumb.classList.remove('active');
        percSucumb.value = '';
        erroSucumb.classList.remove('ativo');
      }
      validar();
    });
    
    checkContrat.addEventListener('change', () => {
      if (checkContrat.checked) {
        divContrat.classList.add('ativo');
        optionContrat.classList.add('active');
      } else {
        divContrat.classList.remove('ativo');
        optionContrat.classList.remove('active');
        percContrat.value = '';
        erroContrat.classList.remove('ativo');
      }
      validar();
    });
    
    function validarDeposito() {
        erroDeposito.classList.remove('ativo');
        if (!valorDeposito.value) return false;
        const v = getValorNumerico(valorDeposito.value);
        if (isNaN(v) || v <= 0) {
        erroDeposito.textContent = 'Valor deve ser maior que zero.';
        erroDeposito.classList.add('ativo');
        return false;
      }
      return true;
    }
    
    function validarSucumb() {
      erroSucumb.classList.remove('ativo');
      if (!checkSucumb.checked) return true;
      if (!percSucumb.value) return false;
      const p = parseFloat(percSucumb.value);
      if (isNaN(p) || p < 0 || p > 100) {
        erroSucumb.textContent = 'Percentual deve estar entre 0 e 100.';
        erroSucumb.classList.add('ativo');
        return false;
      }
      return true;
    }
    
    function validarContrat() {
      erroContrat.classList.remove('ativo');
      if (!checkContrat.checked) return true;
      if (!percContrat.value) return false;
      const p = parseFloat(percContrat.value);
      if (isNaN(p) || p < 0 || p > 100) {
        erroContrat.textContent = 'Percentual deve estar entre 0 e 100.';
        erroContrat.classList.add('ativo');
        return false;
      }
      return true;
    }
    
    function validar() {
      const ok1 = validarDeposito();
      const ok2 = validarSucumb();
      const ok3 = validarContrat();
      const ok4 = checkSucumb.checked || checkContrat.checked;
      
      if (ok1 && ok2 && ok3 && ok4) {
        mostrarResumo();
        btnCalc.disabled = false;
      } else {
        resumo.classList.remove('ativo');
        btnCalc.disabled = true;
      }
    }
    
    function mostrarResumo() {
        const deposito = getValorNumerico(valorDeposito.value);
        let html = `<div class="resumo-item"><strong>Valor do depósito:</strong> ${fmt.format(deposito)}</div>`;
       if (checkSucumb.checked) {
        const p = parseFloat(percSucumb.value);
        html += `<div class="resumo-item"><strong>Honorários sucumbenciais:</strong> ${p.toFixed(2)}%</div>`;
        }
      
       if (checkContrat.checked) {
        const p = parseFloat(percContrat.value);
        html += `<div class="resumo-item"><strong>Honorários contratuais:</strong> ${p.toFixed(2)}%</div>`;
        }
      
      resumoTexto.innerHTML = html;
      resumo.classList.add('ativo');
    }
    
    btnCalc.addEventListener('click', () => {
      const deposito = getValorNumerico(valorDeposito.value);
      let condenacao = deposito;
      let honSucumb = 0;
      let honContrat = 0;
      
      // Calcular honorários sucumbenciais (regra de 3)
      if (checkSucumb.checked) {
        const pSucumb = parseFloat(percSucumb.value) / 100;
        condenacao = deposito / (1 + pSucumb);
        honSucumb = deposito - condenacao;
      }
      
      // Calcular honorários contratuais (sobre condenação)
      if (checkContrat.checked) {
        const pContrat = parseFloat(percContrat.value) / 100;
        honContrat = condenacao * pContrat;
      }
      
      const totalHon = honSucumb + honContrat;
      const valorParte = condenacao - honContrat;
      
      // Salvar dados para certidão
      dadosCalculo = {
        deposito,
        condenacao,
        honSucumb,
        honContrat,
        totalHon,
        valorParte,
        percSucumb: checkSucumb.checked ? parseFloat(percSucumb.value) : 0,
        percContrat: checkContrat.checked ? parseFloat(percContrat.value) : 0,
        temSucumb: checkSucumb.checked,
        temContrat: checkContrat.checked
      };
      
      let detalhes = [];
      detalhes.push(`<div class="card-detalhe"><strong>Valor do depósito:</strong> ${fmt.format(deposito)}</div>`);
      detalhes.push(`<div class="card-detalhe"><strong>Valor da condenação:</strong> ${fmt.format(condenacao)}</div>`);
      
      if (checkSucumb.checked) {
        detalhes.push(`<div class="card-detalhe"><strong>Honorários sucumbenciais (${dadosCalculo.percSucumb.toFixed(2)}%):</strong> ${fmt.format(honSucumb)}</div>`);
      }
      
      if (checkContrat.checked) {
        detalhes.push(`<div class="card-detalhe"><strong>Honorários contratuais (${dadosCalculo.percContrat.toFixed(2)}%):</strong> ${fmt.format(honContrat)}</div>`);
      }
      
      detalhes.push(`<div class="card-detalhe"><strong>Total de honorários:</strong> ${fmt.format(totalHon)}</div>`);
      detalhes.push(`<div class="card-detalhe"><strong>Valor destinado à parte:</strong> ${fmt.format(valorParte)}</div>`);
      
      let html = `<div class="card card-total" style="padding-top: 20px; padding-bottom: 20px;">
        ${detalhes.join('')}
      </div>`;
      
      cardsResultado.innerHTML = html;
      resultado.classList.add('ativo');
      certidaoSection.classList.add('ativo');
      resultado.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
    
    checkCertidao.addEventListener('change', () => {
      if (checkCertidao.checked) {
        certidaoCampos.classList.add('ativo');
        document.getElementById('dataCertidao').value = getHoje();
      } else {
        certidaoCampos.classList.remove('ativo');
      }
      validarCertidao();
    });
    
    function validarCertidao() {
      if (!checkCertidao.checked) {
        btnGerarCertidao.disabled = true;
        btnGerarAlvara.disabled = true;
        return;
      }
      
      const campos = [
        document.getElementById('orgaoJudiciario'),
        document.getElementById('numeroProcesso'),
        document.getElementById('idDeposito'),
        document.getElementById('contaJudicial'),
        document.getElementById('nomeParte'),
        document.getElementById('cpfParte'),
        document.getElementById('nomeAdvogado'),
        document.getElementById('oabAdvogado'),
        document.getElementById('nomeServidor'),
        document.getElementById('cargoServidor'),
        document.getElementById('dataCertidao')
      ];
      
      const todosPreenchidos = campos.every(c => c.value.trim() !== '');
      btnGerarCertidao.disabled = !todosPreenchidos;
      btnGerarAlvara.disabled = !todosPreenchidos;
    }
    
    [
      'orgaoJudiciario', 'numeroProcesso', 'idDeposito', 'contaJudicial',
      'nomeParte', 'cpfParte', 'nomeAdvogado', 'oabAdvogado',
      'nomeServidor', 'cargoServidor', 'dataCertidao'
    ].forEach(id => {
      document.getElementById(id).addEventListener('input', validarCertidao);
    });
    
    btnGerarCertidao.addEventListener('click', () => {
      const d = dadosCalculo;
      const orgao = document.getElementById('orgaoJudiciario').value;
      const processo = document.getElementById('numeroProcesso').value;
      const idDep = document.getElementById('idDeposito').value;
      const conta = document.getElementById('contaJudicial').value;
      const parte = document.getElementById('nomeParte').value;
      const cpf = document.getElementById('cpfParte').value;
      const advogado = document.getElementById('nomeAdvogado').value;
      const oab = document.getElementById('oabAdvogado').value;
      const sentenca = document.getElementById('idSentenca').value;
      const contrato = document.getElementById('idContrato').value;
      const servidor = document.getElementById('nomeServidor').value;
      const cargo = document.getElementById('cargoServidor').value;
      const data = document.getElementById('dataCertidao').value;
      
      let html = `<div class="orgao">${orgao}</div>`;
      html += `<div class="titulo">CERTIDÃO DE APURAÇÃO DE HONORÁRIOS ADVOCATÍCIOS</div>`;
      html += `<div class="corpo">Certifico, para os devidos fins, que nos autos do processo nº <strong>${processo}</strong>, foi realizada a apuração de honorários advocatícios incidentes sobre o depósito judicial ID <strong>${idDep}</strong>, vinculado à conta judicial nº <strong>${conta}</strong>, conforme discriminação a seguir:</div>`;
      
      html += `<table>`;
      html += `<tr><th>Descrição</th><th>Valor (R$)</th></tr>`;
      html += `<tr><td>Valor total do depósito judicial</td><td>${fmt.format(d.deposito)}</td></tr>`;
      html += `<tr><td>Valor da condenação</td><td>${fmt.format(d.condenacao)}</td></tr>`;
      
      if (d.temSucumb) {
        html += `<tr><td>Honorários sucumbenciais (${d.percSucumb.toFixed(2)}%)`;
        if (sentenca) html += `<br><small>${sentenca}</small>`;
        html += `</td><td>${fmt.format(d.honSucumb)}</td></tr>`;
      }
      
      if (d.temContrat) {
        html += `<tr><td>Honorários contratuais (${d.percContrat.toFixed(2)}%)`;
        if (contrato) html += `<br><small>${contrato}</small>`;
        html += `</td><td>${fmt.format(d.honContrat)}</td></tr>`;
      }
      
      html += `<tr><td><strong>Total de honorários</strong></td><td><strong>${fmt.format(d.totalHon)}</strong></td></tr>`;
      html += `<tr><td><strong>Valor destinado à parte</strong></td><td><strong>${fmt.format(d.valorParte)}</strong></td></tr>`;
      html += `</table>`;
      
      html += `<div class="corpo"><strong>Beneficiários:</strong></div>`;
      html += `<div class="corpo">• Advogado(a): <strong>${advogado}</strong>, OAB/${oab} - Valor: <strong>${fmt.format(d.totalHon)}</strong> (${valorPorExtenso(d.totalHon)})</div>`;
      html += `<div class="corpo">• Parte: <strong>${parte}</strong>, CPF ${cpf} - Valor: <strong>${fmt.format(d.valorParte)}</strong> (${valorPorExtenso(d.valorParte)})</div>`;
      
      html += `<div class="corpo" style="margin-top:30px;">O presente foi emitido em ${formatarData(data)}.</div>`;
      
      html += `<div class="assinatura">`;
      html += `<div class="assinatura-linha"></div>`;
      html += `<div><strong>${servidor}</strong></div>`;
      html += `<div><strong>${cargo}</strong></div>`;
      html += `</div>`;
      
      document.getElementById('certidaoConteudo').innerHTML = html;
      document.getElementById('modalCertidao').classList.add('ativo');
    });
    
    btnGerarAlvara.addEventListener('click', () => {
      const d = dadosCalculo;
      const orgao = document.getElementById('orgaoJudiciario').value;
      const processo = document.getElementById('numeroProcesso').value;
      const idDep = document.getElementById('idDeposito').value;
      const conta = document.getElementById('contaJudicial').value;
      const parte = document.getElementById('nomeParte').value;
      const cpf = document.getElementById('cpfParte').value;
      const advogado = document.getElementById('nomeAdvogado').value;
      const oab = document.getElementById('oabAdvogado').value;
      const data = document.getElementById('dataCertidao').value;
      
      let tipoHon = '';
      if (d.temSucumb && d.temContrat) tipoHon = 'honorários sucumbenciais e contratuais';
      else if (d.temSucumb) tipoHon = 'honorários sucumbenciais';
      else if (d.temContrat) tipoHon = 'honorários contratuais';
      
      let texto = `Por meio do presente alvará o MM. Juiz da ${orgao} autoriza a liberação de recursos mantidos na conta judicial nº ${conta}, vinculada ao depósito judicial ID ${idDep}, nos autos do processo nº ${processo}, da seguinte forma:\n\n`;
      
      texto += `a) ${fmt.format(d.totalHon)} (${valorPorExtenso(d.totalHon)}), referente a ${tipoHon}, em favor de ${advogado}, OAB/${oab};\n\n`;
      
      texto += `b) ${fmt.format(d.valorParte)} (${valorPorExtenso(d.valorParte)}), correspondente ao saldo remanescente da condenação, em favor de ${parte}, CPF ${cpf}.\n\n`;
      
      texto += `${formatarData(data)}.`;
      
      document.getElementById('alvaraConteudo').textContent = texto;
      document.getElementById('modalAlvara').classList.add('ativo');
    });
    
    valorDeposito.addEventListener('input', () => {
        formatarInputMilhar(valorDeposito);
        validar();
    });
    percSucumb.addEventListener('input', validar);
    percContrat.addEventListener('input', validar);

  </script>
</body>
</html>